<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="favicon.ico">
    <title>Mumatec Tasking</title>
<script>
  if (localStorage.getItem('mumatecTheme') === 'dark') {
    document.documentElement.classList.add('dark-mode');
  }
</script>
    <link id="styleLink" rel="stylesheet" href="styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="check-environment.js"></script>
    <script src="style.js"></script>
    <script type="module" src="src/app-shell.js"></script>
    <script>applySavedTheme();applySavedDesignSystem();</script>
</head>
<body data-shell-page="control-center" data-page-title="Hosting Control Center" data-page-subtitle="Operational oversight for Mumatec hosting">
    <div id="loadingOverlay" class="loading-overlay" style="display:none;">Loading...</div>
    <div id="appShellHeader"></div>
    <!-- App Shell -->
    <div class="app-container">
        <!-- Sidebar -->
        <div id="appShellSidebar"></div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Content Area -->
            <div class="content-area">
                <!-- Dashboard View -->
                <div class="view-container active" id="dashboardView">
                    <div class="dashboard-hero">
                        <div class="hero-copy">
                            <span class="hero-kicker">Today</span>
                            <h1 class="hero-title">Hosting Control Center</h1>
                            <p class="hero-subtitle">Keep every initiative in view with a calm, precise dashboard crafted for Mumatec.</p>
                        </div>
                        <div class="hero-actions">
                            <button type="button" class="hero-primary" onclick="todoApp.openAddTaskModal('todo')">
                                <span class="material-icons" aria-hidden="true">add</span>
                                New Task
                            </button>
                            <button type="button" class="hero-secondary" onclick="document.getElementById('todayView').scrollIntoView({ behavior: 'smooth' });">
                                <span class="material-icons" aria-hidden="true">bolt</span>
                                Focus Mode
                            </button>
                        </div>
                    </div>

                    <!-- Quick Stats -->
                    <div class="quick-stats">
                        <div class="stat-card">
                            <div class="stat-icon material-icons">assignment</div>
                            <div class="stat-content">
                                <div class="stat-number" id="totalTasks">0</div>
                                <div class="stat-label">Total Tasks</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon material-icons">check_circle</div>
                            <div class="stat-content">
                                <div class="stat-number" id="completedTasks">0</div>
                                <div class="stat-label">Completed</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon material-icons">hourglass_empty</div>
                            <div class="stat-content">
                                <div class="stat-number" id="pendingTasks">0</div>
                                <div class="stat-label">In Progress</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon material-icons">whatshot</div>
                            <div class="stat-content">
                                <div class="stat-number" id="streakDays">0</div>
                                <div class="stat-label">Day Streak</div>
                            </div>
                        </div>
                    </div>

                    <!-- Main Dashboard Content -->
                    <div class="dashboard-grid">
                        <!-- Kanban Board -->
                        <div class="kanban-container">
                            <div class="kanban-column" data-status="todo">
                                <div class="column-header">
                                    <div class="column-title">Todo</div>
                                    <div class="column-meta">
                                        <div class="column-count" id="todoCount">0</div>
                                        <div class="column-controls">
                                            <button class="move-btn move-col" data-status="todo" data-direction="left" aria-label="Move column left" type="button"><span class="material-icons" aria-hidden="true">arrow_left</span></button>
                                            <button class="move-btn move-col" data-status="todo" data-direction="right" aria-label="Move column right" type="button"><span class="material-icons" aria-hidden="true">arrow_right</span></button>
                                        </div>
                                    </div>
                                </div>
                                <div class="column-content" id="todoBoard">
                                    <div class="add-task-card" onclick="todoApp.openAddTaskModal('todo')">
                                        <span class="material-icons add-icon" aria-hidden="true">add</span>
                                        <span>Add task</span>
                                    </div>
                                </div>
                            </div>

                            <div class="kanban-column" data-status="inprogress">
                                <div class="column-header">
                                    <div class="column-title">In Progress</div>
                                    <div class="column-meta">
                                        <div class="column-count" id="inprogressCount">0</div>
                                        <div class="column-controls">
                                            <button class="move-btn move-col" data-status="inprogress" data-direction="left" aria-label="Move column left" type="button"><span class="material-icons" aria-hidden="true">arrow_left</span></button>
                                            <button class="move-btn move-col" data-status="inprogress" data-direction="right" aria-label="Move column right" type="button"><span class="material-icons" aria-hidden="true">arrow_right</span></button>
                                        </div>
                                    </div>
                                </div>
                                <div class="column-content" id="inprogressBoard">
                                    <div class="add-task-card" onclick="todoApp.openAddTaskModal('inprogress')">
                                        <span class="material-icons add-icon" aria-hidden="true">add</span>
                                        <span>Add task</span>
                                    </div>
                                </div>
                            </div>

                            <div class="kanban-column" data-status="done">
                                <div class="column-header">
                                    <div class="column-title">Done</div>
                                    <div class="column-meta">
                                        <div class="column-count" id="doneCount">0</div>
                                        <div class="column-controls">
                                            <button class="move-btn move-col" data-status="done" data-direction="left" aria-label="Move column left" type="button"><span class="material-icons" aria-hidden="true">arrow_left</span></button>
                                            <button class="move-btn move-col" data-status="done" data-direction="right" aria-label="Move column right" type="button"><span class="material-icons" aria-hidden="true">arrow_right</span></button>
                                        </div>
                                    </div>
                                </div>
                                <div class="column-content" id="doneBoard">
                                    <div class="add-task-card" onclick="todoApp.openAddTaskModal('done')">
                                        <span class="material-icons add-icon" aria-hidden="true">add</span>
                                        <span>Add task</span>
                                    </div>
                                </div>
                            </div>

                            <div class="kanban-column" data-status="review">
                                <div class="column-header">
                                    <div class="column-title">Under Review</div>
                                    <div class="column-meta">
                                        <div class="column-count" id="reviewCount">0</div>
                                        <div class="column-controls">
                                            <button class="move-btn move-col" data-status="review" data-direction="left" aria-label="Move column left" type="button"><span class="material-icons" aria-hidden="true">arrow_left</span></button>
                                            <button class="move-btn move-col" data-status="review" data-direction="right" aria-label="Move column right" type="button"><span class="material-icons" aria-hidden="true">arrow_right</span></button>
                                        </div>
                                    </div>
                                </div>
                                <div class="column-content" id="reviewBoard">
                                    <div class="add-task-card" onclick="todoApp.openAddTaskModal('review')">
                                        <span class="material-icons add-icon" aria-hidden="true">add</span>
                                        <span>Add task</span>
                                    </div>
                                </div>
                            </div>

                            <div class="kanban-column" data-status="blocked">
                                <div class="column-header">
                                    <div class="column-title">Blocked</div>
                                    <div class="column-meta">
                                        <div class="column-count" id="blockedCount">0</div>
                                        <div class="column-controls">
                                            <button class="move-btn move-col" data-status="blocked" data-direction="left" aria-label="Move column left" type="button"><span class="material-icons" aria-hidden="true">arrow_left</span></button>
                                            <button class="move-btn move-col" data-status="blocked" data-direction="right" aria-label="Move column right" type="button"><span class="material-icons" aria-hidden="true">arrow_right</span></button>
                                        </div>
                                    </div>
                                </div>
                                <div class="column-content" id="blockedBoard">
                                    <div class="add-task-card" onclick="todoApp.openAddTaskModal('blocked')">
                                        <span class="material-icons add-icon" aria-hidden="true">add</span>
                                        <span>Add task</span>
                                    </div>
                                </div>
                            </div>

                            <div class="kanban-column" data-status="cancelled">
                                <div class="column-header">
                                    <div class="column-title">Cancelled</div>
                                    <div class="column-meta">
                                        <div class="column-count" id="cancelledCount">0</div>
                                        <div class="column-controls">
                                            <button class="move-btn move-col" data-status="cancelled" data-direction="left" aria-label="Move column left" type="button"><span class="material-icons" aria-hidden="true">arrow_left</span></button>
                                            <button class="move-btn move-col" data-status="cancelled" data-direction="right" aria-label="Move column right" type="button"><span class="material-icons" aria-hidden="true">arrow_right</span></button>
                                        </div>
                                    </div>
                                </div>
                                <div class="column-content" id="cancelledBoard">
                                    <div class="add-task-card" onclick="todoApp.openAddTaskModal('cancelled')">
                                        <span class="material-icons add-icon" aria-hidden="true">add</span>
                                        <span>Add task</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

                <div class="rows-container" id="rowsContainer"></div>
                <!-- Other Views (Today, Upcoming, etc.) -->
                <div class="view-container" id="todayView">
                    <div class="today-content">
                        <div class="today-header">
                            <h2>Infrastructure Status</h2>
                            <div class="today-date" id="todayDate"></div>
                        </div>
                        <div class="today-tasks" id="todayTasks"></div>
                    </div>
                </div>

                <div class="view-container" id="upcomingView">
                    <div class="upcoming-content">
                        <h2>Incident Queue</h2>
                        <div class="upcoming-timeline" id="upcomingTimeline"></div>
                    </div>
                </div>

                <div class="view-container" id="completedView">
                    <div class="completed-content">
                        <h2>Scheduled Maintenance</h2>
                        <div class="completed-list" id="completedList"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Task Modal -->
    <div class="modal-overlay" id="taskModal" role="dialog" aria-hidden="true">
        <div class="task-modal">
            <div class="modal-header">
                <h3 id="modalTitle">Add New Task</h3>
                <button type="button" id="watchTaskBtn" class="watch-btn" aria-label="Watch task"><span class="material-icons" aria-hidden="true">notifications_off</span></button>
                <button class="close-btn" onclick="todoApp.closeModal()" type="button"><span class="material-icons" aria-hidden="true">close</span></button>
            </div>
            <div class="hint-banner">Fill in the essentials. You can edit details later.</div>
            <div class="tab-header" role="tablist">
                <button type="button" class="tab-btn active" data-tab="detailsTab">Details</button>
                <button type="button" class="tab-btn" data-tab="commentsTab">Comments <span id="commentsCount"></span></button>
                <button type="button" class="tab-btn" data-tab="activityTab">Activity</button>
                <button type="button" class="tab-btn" data-tab="attachmentsTab">Attachments</button>
            </div>
            <form id="taskForm" class="task-form">
                <div id="detailsTab" class="tab-content active">
                <div class="form-field">
                    <label>Task Title<span class="required">*</span></label>
                    <input type="text" id="taskTitle" placeholder="Brief summary" required>
                </div>
                <div class="form-row">
                    <div class="form-field">
                        <label>Project<span class="required">*</span></label>
                        <div class="project-select">
                            <select id="taskProject"></select>
                            <button type="button" id="newProjectBtn" class="new-project-btn">+</button>
                        </div>
                    </div>
                    <div class="form-field">
                        <label>Assignee</label>
                        <select id="taskAssignee"></select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-field">
                        <label>Priority</label>
                        <div id="priorityBadges" class="priority-badges">
                            <span class="priority-badge high" data-value="high">High</span>
                            <span class="priority-badge medium active" data-value="medium">Medium</span>
                            <span class="priority-badge low" data-value="low">Low</span>
                        </div>
                        <input type="hidden" id="taskPriority" value="medium">
                    </div>
                    <div class="form-field">
                        <label>Due Date</label>
                        <input type="datetime-local" id="taskDueDate">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-field" id="taskCategoryField">
                        <label>Category</label>
                        <input type="text" id="taskCategory" placeholder="e.g., Work, Personal">
                    </div>
                    <div class="form-field" id="taskTypeField">
                        <label>Type</label>
                        <input type="text" id="taskType" list="typeSuggestions" placeholder="e.g., Bug">
                        <datalist id="typeSuggestions"></datalist>
                    </div>
                </div>
                <div class="form-field">
                    <label>Description</label>
                    <textarea id="taskDescription" rows="3" placeholder="Add more context"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-field">
                        <label>Est. Hours</label>
                        <input type="number" id="taskEstimate" min="0" step="0.1">
                    </div>
                    <div class="form-field">
                        <label>Tags</label>
                        <input type="text" id="taskTags" placeholder="urgent, meeting, project">
                    </div>
                </div>
                <div class="form-field">
                    <label>Time Tracking</label>
                    <div class="modal-timer">
                        <span class="timer-indicator" id="modalTimerIndicator"></span>
                        <button type="button" id="modalTimerStart" class="timer-btn">Start</button>
                        <button type="button" id="modalTimerStop" class="timer-btn">Stop</button>
                        <span id="modalTimeSpent"></span>
                    </div>
                </div>
                </div> <!-- end detailsTab -->
                <div id="commentsTab" class="tab-content">
                    <div id="commentsContainer" class="comments-container"></div>
                    <div class="comment-editor">
                        <textarea id="taskComment" rows="2" placeholder="Add a comment"></textarea>
                        <button type="button" id="addCommentBtn" class="form-btn primary">Add Comment</button>
                    </div>
                </div>
                <div id="activityTab" class="tab-content">
                    <div id="activityFeed" class="activity-feed"></div>
                </div>
                <div id="attachmentsTab" class="tab-content">
                    <div id="attachmentDropZone" class="drop-zone">Drop files here or click to browse<input type="file" id="taskAttachments" multiple style="display:none;"></div>
                    <div id="attachmentsList" class="attachments-list"></div>
                </div>
                <input type="hidden" id="taskStatus" value="todo">
                <div class="form-actions">
                    <button type="button" class="form-btn secondary" onclick="todoApp.closeModal()">Cancel</button>
                    <button type="submit" class="form-btn primary">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Insights Modal -->
    <div class="modal-overlay" id="insightsModal" role="dialog" aria-modal="true" aria-labelledby="insightsTitle">
        <div class="insights-modal">
            <div class="modal-header">
                <h3 id="insightsTitle"><span class="material-icons">bar_chart</span> Insights</h3>
                <button class="close-btn" id="insightsClose" aria-label="Close insights" onclick="todoApp.closeInsights()" type="button"><span class="material-icons" aria-hidden="true">close</span></button>
            </div>
            <div class="insights-grid">
                <div class="insight-metric">
                    <div class="metric-label">This Week</div>
                    <div class="metric-value" id="weeklyCompleted">0</div>
                    <div class="metric-change positive" id="weeklyChange">+0%</div>
                </div>
                <div class="insight-metric">
                    <div class="metric-label">Average Daily</div>
                    <div class="metric-value" id="dailyAverage">0</div>
                    <div class="metric-trend"><span class="material-icons">show_chart</span></div>
                </div>
                <div class="insight-metric">
                    <div class="metric-label">Most Productive</div>
                    <div class="metric-value" id="bestDay">Mon</div>
                    <div class="metric-trend"><span class="material-icons">star</span></div>
                </div>
                <div class="insight-metric">
                    <div class="metric-label">Focus Score</div>
                    <div class="metric-value" id="focusScore">95%</div>
                    <div class="metric-trend"><span class="material-icons">my_location</span></div>
                </div>
            </div>

            <div class="weekly-chart">
                <div class="chart-header">Weekly Activity</div>
                <div class="chart-bars" id="weeklyChart"></div>
            </div>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script>M.AutoInit();</script>

    <!-- File Input -->
    <input type="file" id="csvImport" accept=".csv" style="display: none;">

    <!-- Notifications -->
    <div class="notification-container" id="notificationContainer"></div>

    <script type="module" src="firebase.js"></script>
    <script type="module" src="auth.js"></script>
    <script type="module" src="src/main.js"></script>
</body>
</html>
